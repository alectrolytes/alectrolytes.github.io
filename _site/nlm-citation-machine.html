<!DOCTYPE html>
<html lang="en">
<head>
  <title>Team Nexus - NLM Citation Machine</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- references -->
  <link rel="stylesheet" href="/css/bootstrap.css"/>
  <link rel="stylesheet" type="text/css" href="/css/main.css"/>
  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

  <!-- Google app site verification -->
  <meta name="google-site-verification" content="KMhoH7MFXEz60ENtC4NoGTtmY0BtWVQnot7stbivRjg"/>

  <!-- Google Analytics -->
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68972442-1', 'auto');
  ga('send', 'pageview');
  </script>
  <!-- End Google Analytics -->

  <!-- fonts -->
  <style>
    @font-face {
      font-family: Mentone;
      src: url(/fonts/mentone-semibol.otf)
    }
    @font-face {
      font-family: Lato;
      src: url(/fonts/Lato-Regular.woff)
    }
    @font-face {
      font-family: Museo500;
      src: url(/fonts/Museo500.woff)
    }
    @font-face {
      font-family: Museo300;
      src: url(/fonts/MuseoSans-300.otf)
    }
    @font-face {
      font-family: Museo700;
      src: url(/fonts/MuseoSans_700.otf)
    }
    @font-face {
      font-family: Museo900;
      src: url(/fonts/MuseoSans_900.otf)
    }
    @font-face {
      font-family: HelveticaNeueLTStd;
      src: url(/fonts/HelveticaNeueLTStd-Md.otf)
    }
    @font-face {
      font-family: RobotoLight;
      src: url(/fonts/Roboto-Light.ttf)
    }
    @font-face {
      font-family: OpenSans;
      src: url(fonts/OpenSans-Regular.ttf)
    }
    @@font-face {
      font-family: Hind;
      src: url(fonts/Hind-Regular.ttf)
    }
  </style>

  <!-- favicon -->
  <link rel="shortcut icon" href="teamnexus-favicon.ico"/>


      <link rel="stylesheet" href="/css/citation.css"/>
  <meta name="description" content="Automagically generate an NLM citation using a PubMed ID or an ISBN."/>
</head>
<body>

<!-- Facebook Like Script -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<!-- Google +1 Script -->
<script src="https://apis.google.com/js/platform.js" async defer></script>

<!-- background tint-->
<div class="overlay"></div>

<!-- awesome zoom box navbar! -->
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div id="projects-btn" class="box">
      Projects
      <span class="top"></span>
      <span class="right"></span>
      <span class="bottom"></span>
      <span class="left"></span>
      <a href="http://teamnex.us/#3" class="boxlink"></a>
    </div>
  </div>
</nav>

<!-- Google +1 and Facebook Like buttons -->
<div class="social">
  <span class="fb-like" data-href="http://teamnex.us/nlm-citation-machine" data-layout="button_count" data-action="like" data-show-faces="false" data-share="false" style="vertical-align:top !important"></span>
  <span class="g-plusone" data-size="medium" data-annotation="bubble"></span>
</div>

<!-- citation form -->
<div id="citation-container">
  <div id="nlm-description">
    <h2>NLM Citation Machine</h2>
    <p>Generate NLM style citations for articles in <a href="http://www.ncbi.nlm.nih.gov/pubmed">PubMed</a> and books in <a href="https://books.google.com">Google Books</a>.</p>
    <p>Enter PubMed ID or ISBN. Click generate. Simple.</p>
    <p>Useful references:</p>
    <ul>
      <li>DiPiro: 0071800549</li>
      <li>CHEST: 22315268</li>
      <li>ACC/AHA Cholesterol: 24239923</li>
      <li>NLA Dyslipidemia Part 1: 25911072</li>
    </ul>
    <p>Recommendations for the website? Email me at: <a href="mailto:alec@teamnex.us">alec@teamnex.us</a></p>
  </div>
  <form id="citation-form">
    <input type="search" id="query" placeholder="Enter PubMed ID or ISBN here:"> <br>
    <input type="submit" id="generate-btn" value="Generate!" onclick="generateCitation()"> <br>
    <textarea readonly id="citation" rows="5"></textarea>
  </form>
</div>

<script>
$('#citation-form').submit(function() {
  generateCitation();
  return false;
})

function Get(yourUrl){
  var Httpreq = new XMLHttpRequest();
  Httpreq.open("GET",yourUrl,false);
  Httpreq.send(null);
  return Httpreq.responseText;
}

function generateCitation() {
  var search = document.getElementById('query').value;

  // determines if input is ISBN or PubMedID
  if (Number.isInteger(parseInt(search))) { // ISBN citation
    var search_length = search.length;
    if (search_length === 10 || search_length === 13) {
      // parse JSON into js object
      var json_obj = JSON.parse(Get('https://www.googleapis.com/books/v1/volumes?q=isbn:' + search));
      // isolate nested book object
      var book = json_obj.items[0].volumeInfo;
      // arrange author names
      var author_count = 0;
      var name_nlm = "";
      for (name in book.authors) {
        var name_array = book.authors[name].split(" ");
        // if (author_count < 3) {
          name_nlm = name_nlm.concat(name_array[name_array.length - 1] + ' ' + name_array[0].charAt(0));
        // } else if(author_count === 4){
        //   name_nlm = name_nlm.concat('et al');
        // }
        author_count++;
        if (author_count === book.authors.length) {
          name_nlm = name_nlm.concat('. ')
        } else if (author_count < book.authors.length) {
          name_nlm = name_nlm.concat(', ')
        }
      }
      // generate NLM book citation
      var citation = name_nlm +  book.title + '. ' + book.publisher + '; ' + book.publishedDate + '. ' + book.pageCount + ' p.';
    } else { // PubMed citation
      // parse JSON into js object
      var json_obj = JSON.parse(Get('http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=pubmed&retmode=json&rettype=abstract&id=' + search));
      // isolate nested article object
      var article = json_obj.result[search];
      // arrange author names
      var author_count = 0;
      var name_nlm = "";
      for (name in article.authors) {
        // if (author_count < 3) {
          name_nlm = name_nlm.concat(article.authors[name].name);
        // } else if(author_count === 4){
        // //   name_nlm = name_nlm.concat('et al');
        // // }
        author_count++;
        if (author_count === article.authors.length) {
          name_nlm = name_nlm.concat('. ')
        } else if (author_count < article.authors.length) {
          name_nlm = name_nlm.concat(', ')
        }
      }
      // generate NLM article citation depending if volume and issue are variables
      var citation = name_nlm + article.title + ' ' + article.source + '. ' + article.pubdate;
      if (article.volume !== '') {
        citation += ';' + article.volume;
      }
      if (article.issue != '') {
        citation += '(' + article.issue + ')';
      }
      if (article.pages != '') {
        citation += ':' + article.pages;
      }
      citation += '.';
    }
  }

  // print citation
  // console.log(citation);
  document.getElementById('citation').value = citation;
}
</script>


</body>
</html>
<!-- Made by Team Nexus -->

